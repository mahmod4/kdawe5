<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>تفاصيل المنتج</title>
  <link rel="stylesheet" href="./css/styles.css" />
  <link rel="stylesheet" href="./css/weight.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="./js/ui.js"></script>
  <script src="./js/runtime-env-client.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, query, where, orderBy, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    const env = (window.RUNTIME_ENV && typeof window.RUNTIME_ENV === 'object') ? window.RUNTIME_ENV : {};
    const firebaseConfig = {
      apiKey: env.FIREBASE_API_KEY || "AIzaSyAWkruoIMbTxD-5DHCpspPY8p2TtZLLmLM",
      authDomain: env.FIREBASE_AUTH_DOMAIN || "dashboard-27bc8.firebaseapp.com",
      projectId: env.FIREBASE_PROJECT_ID || "dashboard-27bc8",
      storageBucket: env.FIREBASE_STORAGE_BUCKET || "dashboard-27bc8.firebasestorage.app",
      messagingSenderId: env.FIREBASE_MESSAGING_SENDER_ID || "707339591256",
      appId: env.FIREBASE_APP_ID || "1:707339591256:web:dcc2649182e97249a2742d",
      measurementId: env.FIREBASE_MEASUREMENT_ID || "G-K8FNNYH4S1"
    };

    try {
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      window.firebase = {
        app,
        auth: () => auth,
        firestore: () => db
      };

      window.firebaseAuth = {
        GoogleAuthProvider,
        signInWithPopup,
        signOut,
        onAuthStateChanged
      };

      window.firebaseFirestore = {
        collection,
        addDoc,
        query,
        where,
        orderBy,
        getDocs,
        doc,
        getDoc
      };
    } catch (error) {
      console.error('خطأ في تهيئة Firebase:', error);
    }
  </script>
</head>
<body>
  <header>
    <div class="logo-container">
      <a href="index.html" style="display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit;">
        <img src="../images/default-logo.png" alt="شعار المتجر" class="logo" width="60" height="60" data-store-logo />
        <h1 data-store-name>المتجر</h1>
      </a>
    </div>
    <nav class="main-menu" id="main-menu">
      <ul>
        <li><a href="index.html#home" class="menu-item"><i data-lucide="home"></i> الرئيسية</a></li>
        <li><a href="index.html#products" class="menu-item"><i data-lucide="shopping-bag"></i> المنتجات</a></li>
        <li><a href="cart.html" class="menu-item"><i data-lucide="shopping-cart"></i> السلة</a></li>
        <li><a href="contact.html" class="menu-item"><i data-lucide="store"></i> عن المتجر</a></li>
      </ul>
    </nav>
  </header>

  <main class="container" style="padding: 20px 16px; max-width: 900px; margin: 0 auto;">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:12px;">
      <a href="index.html#products" class="btn" style="text-align:center;">رجوع</a>
      <h2 id="product-title" style="margin:0;">تفاصيل المنتج</h2>
      <button id="share-btn" class="btn" style="text-align:center;" title="مشاركة المنتج">
        <i data-lucide="share-2"></i>
      </button>
    </div>

    <div id="product-details" class="card" style="padding:16px;">
      <p>جاري التحميل...</p>
    </div>

    <div id="similar-products-section" style="margin-top:24px; display:none;">
      <h3 style="margin:0 0 12px;">منتجات مشابهة</h3>
      <div id="similar-products-container" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)); gap:16px;"></div>
    </div>
  </main>

  <script src="./js/settings.js"></script>
  <script src="./js/settings-sync.js" type="module"></script>
  <script src="./js/weight-service.js"></script>
  <script>lucide.createIcons();</script>
  <script src="./js/product.js"></script>
</body>
</html>
